USE Treinamento
GO

DECLARE	@TAB TABLE ([ANO] INT ,[VLR] decimal(15,4))

Insert Into @TAB ([ANO],[VLR])
Values  (1999,120),(2000,121),(2001,122),(2002,123),(2003,124)
       ,(2004,125),(2005,126),(2006,127),(2007,128),(2008,129)

--SELECT * FROM @TAB t	


--FIRST_VALUE() 

SELECT 
	 t.ANO
	,FIRST_VALUE(ANO) OVER (ORDER BY ANO) AS [PRIMEIRO_VALOR]
FROM @TAB t

--LAST_VALUE()

SELECT 
	 t.ANO
	,LAST_VALUE(ANO) OVER (ORDER BY ANO ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING ) AS [ULTIMO_VALOR]
FROM @TAB t


DECLARE @T TABLE ( ID INT IDENTITY(1,1), CLIENTEID INT , VLR DECIMAL(15,4))
INSERT INTO @T (CLIENTEID, VLR) 
VALUES (1, 10), (1, 11), (2,19), (2,22), (2, 18), (1,20)


SELECT 
	 ID
	,CLIENTEID
	,VLR
	,FIRST_VALUE(ID) OVER (PARTITION BY CLIENTEID ORDER BY ID) AS 'T'
FROM @T
S
SELECT 
	 ID
	,CLIENTEID
	,VLR
	,LAST_VALUE(ID) OVER (PARTITION BY CLIENTEID ORDER BY ID) AS 'T'
FROM @T