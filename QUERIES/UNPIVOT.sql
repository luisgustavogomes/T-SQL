--https://sqlfromhell.wordpress.com/2013/08/15/transformando-colunas-em-linhas-com-unpivot/

DECLARE @CONTAS TABLE (
    [BANCO] VARCHAR(100), 
    [ANO] SMALLINT,
    [INVESTIMENTOS] MONEY, 
    [DESPESAS] MONEY
)
 
INSERT INTO @CONTAS VALUES
('BANCO ALVORADA S/A', 2010, 9613906084.01, 8102644.84),
('BANCO ALVORADA S/A', 2011, 174343.35, 7935411.15),
('BANCO ARBI S/A', 2010, 8202652.29, 114215.13),
('BANCO ARBI S/A', 2011, 8407843.72, 81746.25)

SELECT * FROM @CONTAS c
 
SELECT [BANCO], [ANO], [TIPO], [VALOR]
FROM @CONTAS C
UNPIVOT (
    [VALOR] FOR [TIPO] IN ( 
        [INVESTIMENTOS], 
        [DESPESAS]
    )
) AS U
ORDER BY [BANCO], [ANO], [TIPO]

-------------------------------------------------------

DECLARE @CONTAS2 TABLE (
    [BANCO] VARCHAR(100), 
    [TIPO] VARCHAR(100),
    [2010] MONEY, 
    [2011] MONEY
)
 
INSERT INTO @CONTAS2 VALUES
('BANCO ALVORADA S/A', 'INVESTIMENTOS', 9613906084.01, 174343.35),
('BANCO ALVORADA S/A', 'DESPESAS', 8102644.84, 7935411.15),
('BANCO ARBI S/A', 'INVESTIMENTOS', 8202652.29, 8407843.72),
('BANCO ARBI S/A', 'DESPESAS', 114215.13, 81746.25)

SELECT * FROM @CONTAS2
 
SELECT [BANCO], [ANO], [TIPO], [VALOR]
FROM @CONTAS2 C
UNPIVOT (
    [VALOR] FOR [ANO] IN (  
        [2010], 
        [2011]
    )
) AS U
ORDER BY [BANCO], [ANO], [TIPO]


